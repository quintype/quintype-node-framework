<!DOCTYPE html>
<html lang="en">

<head>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-66074042-1', 'auto');ga('send', 'pageview');</script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> routes</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
             
                <a class="image" href="index.html">
                    <img src="https://images.assettype.com/quintype-website/2018-10/013e8cbe-92b4-435f-bbbb-3e101efbc99a/quintype_logo.png?w=180" alt="logo">
                </a>
            
             
                <a href="index.html">
                    <h1 class="navbar-item">@quintype/framework</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        Tutorials
                        <i class="fas fa-chevron-down fa-xs"></i>
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            <a class="dropdown-item" href="tutorial-migrate-from-v6-to-v7.html">
                                Migrate from framework version 6 to 7
                            </a>
                        
                        </div>
                    </div>
                </div>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="module-asset-helper-AssetHelper.html">AssetHelper</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getDomainSpecificOpts">getDomainSpecificOpts</a></li></ul></div><div class="category"><h2>AmpHandler</h2><h3>Global</h3><ul><li><a href="global.html#ampStoryPageHandler">ampStoryPageHandler</a></li></ul></div><div class="category"><h2>Client</h2><h3>Modules</h3><ul><li><a href="module-analytics.html">analytics</a></li><li><a href="module-start.html">start</a></li></ul></div><div class="category"><h2>Isomorphic</h2><h3>Modules</h3><ul><li><a href="module-IsomorphicComponent.html">IsomorphicComponent</a></li><li><a href="module-match-best-route.html">match-best-route</a></li><li><a href="module-pick-component-helper.html">pick-component-helper</a></li></ul></div><div class="category"><h2>Server</h2><h3>Modules</h3><ul><li><a href="module-api-client.html">api-client</a></li><li><a href="module-asset-helper.html">asset-helper</a></li><li><a href="module-caching.html">caching</a></li><li><a href="module-create-app.html">create-app</a></li><li><a href="module-generate-routes.html">generate-routes</a></li><li><a href="module-logger.html">logger</a></li><li><a href="module-publisher-config.html">publisher-config</a></li><li><a href="module-render-loadable-redux-component.html">render-loadable-redux-component</a></li><li><a href="module-render-redux-component.html">render-redux-component</a></li><li><a href="module-routes.html">routes</a></li><li><a href="module-server-start.html">server-start</a></li><li><a href="module-static-configuration.html">static-configuration</a></li></ul></div><div class="category"><h2>Service Worker</h2><h3>Modules</h3><ul><li><a href="module-service-worker-helper.html">service-worker-helper</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Module</p>
                    <h1>routes</h1>
                </header>
                




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><p>This namespace exports multiple utility functions for setting up routes</p>
<pre class="prettyprint source lang-javascript"><code>import { upstreamQuintypeRoutes, isomorphicRoutes, getWithConfig, proxyGetRequest } from &quot;@quintype/framework/server/routes&quot;;
</code></pre></div>
        

        
            














<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line1">line 1</a>
            </span>
        </p>
    
</dl>






















        
    
    </div>
    
    

    

    

    

    

    

    

    
        <div class='vertical-section'>
            <h1>Methods</h1>
            <div class="members">
            
                <div class="member">


    
    <h4 class="name" id=".ampRoutes">
        <a class="href-link" href="#.ampRoutes">#</a>
        
            
                <span class='tag'>static</span>
            
        
        <span class="code-name">
            
                ampRoutes<span class="signature">(app, opts)</span><span class="type-signature"></span>
            
        </span>
    </h4>
    

    
    
    <div class="description">
        <p><em>ampRoutes</em> handles all the amp page routes using the <em><a href="https://developers.quintype.com/quintype-node-amp">@quintype/amp</a></em> library
routes matched:
GET - &quot;/amp/story/:slug&quot;* returns amp story page
GET - &quot;/amp/api/v1/amp-infinite-scroll&quot; returns the infinite scroll config JSON. Passed to <amp-next-page> component's <code>src</code> attribute</p>
    </div>
    









    <h5>Parameters:</h5>
    
<div class="table-container">
    <table class="params table">
        <thead>
        <tr>
            
            <th>Name</th>
            

            <th>Type</th>

            

            

            <th class="last">Description</th>
        </tr>
        </thead>

        <tbody>
        

            
<tr class="deep-level-0">
  
      <td class="name"><code>app</code></td>
  

  <td class="type">
  
      
<code class="param-type">Express</code>


  
  </td>

  

  

  <td class="description last"><p>Express app to add the routes to</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>opts</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>Options object used to configure amp. Passing this is optional</p></td>
</tr>

  
  
    
<tr class="deep-level-1">
  
      <td class="name"><code>templates</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>An object that's used to pass custom templates. Each key corresponds to the template name and corresponding value is the template</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>slots</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>An object used to pass slot data.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>seo</code></td>
  

  <td class="type">
  
      
<code class="param-type">SEO</code>


  
  </td>

  

  

  <td class="description last"><p>An SEO object that will generate html tags for each page. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#quintypeseo">@quintype/seo</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>enableAmp</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>'amp/story/:slug' should redirect to non-amp page if enableAmp is false</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>redirectUrls</code></td>
  

  <td class="type">
  
      
<code class="param-type">object</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>list of urls  which is used to redirect URL(sourceUrl) to a different URL(destinationUrl). Eg:  redirectUrls: { &quot;/amp/story/sports/ipl-2021&quot;: {destinationUrl: &quot;/amp/story/sports/cricket-2022&quot;, statusCode: 302,},}</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>headerCardRender</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>Render prop for story headerCard. If passed, the headerCard in default stories will be replaced with this</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>relatedStoriesRender</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>Render prop for relatedStories in a story page. If passed, this will replace the related stories</p></td>
</tr>

  


        
        </tbody>
    </table>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line665">line 665</a>
            </span>
        </p>
    
</dl>





















</div>
            
                <div class="member">


    
    <h4 class="name" id=".isomorphicRoutes">
        <a class="href-link" href="#.isomorphicRoutes">#</a>
        
            
                <span class='tag'>static</span>
            
        
        <span class="code-name">
            
                isomorphicRoutes<span class="signature">(app, opts, redirectToLowercaseSlugs, shouldEncodeAmpUri, sMaxAge, maxAge, fcmServerKey, appLoadingPlaceholder)</span><span class="type-signature"></span>
            
        </span>
    </h4>
    

    
    
    <div class="description">
        <p><em>isomorphicRoutes</em> brings all the moving parts of the <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture">server side rendering</a> together.
It accepts all the pieces needed, and implements all the plumbing to make these pieces work together.</p>
<p>Note that <em>isomorphicRoutes</em> adds a route that matches <em>/*</em>, so it should be near the end of your <em>app/server/app.js</em>.</p>
    </div>
    









    <h5>Parameters:</h5>
    
<div class="table-container">
    <table class="params table">
        <thead>
        <tr>
            
            <th>Name</th>
            

            <th>Type</th>

            

            

            <th class="last">Description</th>
        </tr>
        </thead>

        <tbody>
        

            
<tr class="deep-level-0">
  
      <td class="name"><code>app</code></td>
  

  <td class="type">
  
      
<code class="param-type">Express</code>


  
  </td>

  

  

  <td class="description last"><p>Express app to add the routes to</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>opts</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>Options</p></td>
</tr>

  
  
    
<tr class="deep-level-1">
  
      <td class="name"><code>generateRoutes</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>A function that generates routes to be matched given a config. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#routing">routing</a> for more information. This call should be memoized, as it's called on every request</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>renderLayout</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>A function that renders the layout given the content injected by <em>isomorphicRoutes</em>. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#renderlayout">renderLayout</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>loadData</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function that loads data for the page, given the <em>pageType</em>. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#loaddata">loadData</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>pickComponent</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function that picks the correct component for rendering each <em>pageType</em>. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#pickcomponent">pickComponent</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>loadErrorData</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function that loads data if there is an error. If <em>handleNotFound</em> is set to true, this function is also called to load data for the 404 page</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>seo</code></td>
  

  <td class="type">
  
      
<code class="param-type">SEO</code>


  
  </td>

  

  

  <td class="description last"><p>An SEO object that will generate html tags for each page. See <a href="https://developers.quintype.com/malibu/isomorphic-rendering/server-side-architecture#quintypeseo">@quintype/seo</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>manifestFn</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function that accepts the <em>config</em>, and returns content for the <em>/manifest.json</em>. Common fields like <em>name</em>, <em>start_url</em> will be populated by default, but can be owerwritten. If not set, then manifest will not be generated.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>assetLinkFn</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function that accepts <em>config</em> and returns <em>{ packageName, authorizedKeys }</em> for the Android <em>/.well-known/assetlinks.json</em>. If not implemented, then AssetLinks will return a 404.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>oneSignalServiceWorkers</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>Deprecated: If set to true, then generate <em>/OneSignalSKDWorker.js</em> which combines the Quintype worker as well as OneSignal's worker. (default: false). Please see <a href="https://developers.quintype.com/malibu/tutorial/onesignal">https://developers.quintype.com/malibu/tutorial/onesignal</a></p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>staticRoutes</code></td>
  

  <td class="type">
  
      
<code class="param-type">*</code>


  
  </td>

  

  

  <td class="description last"><p>WIP: List of static routes</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>serviceWorkerPaths</code></td>
  

  <td class="type">
  
      
<code class="param-type">Array.&lt;string></code>


  
  </td>

  

  

  <td class="description last"><p>List of paths to host the service worker on (default: [&quot;/service-worker.js&quot;])s</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>appVersion</code></td>
  

  <td class="type">
  
      
<code class="param-type">number</code>


  
  </td>

  

  

  <td class="description last"><p>The version of this app. In case there is a version mismatch between server and client, then client will update ServiceWorker in the background. See <em>app/isomorphic/app-version.js</em>.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>preloadJs</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>Return a <em>Link</em> header preloading JS files. In h/2 compatible browsers, this Js will be pushed. (default: false)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>preloadRouteData</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>Return a <em>Link</em> header preloading <em>/route-data.json</em>. In h/2 compatible browsers, this Js will be pushed. (default: false)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>handleCustomRoute</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>If the page is not matched as an isomorphic route, then match against a static page or redirect in the CMS, and behave accordingly. Note, this runs after the isomorphic routes, so any live stories or sections will take precedence over a redirection set up in the editor. (default: true)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>handleNotFound</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then handle 404 pages with <em>pageType</em> set to <em>&quot;not-found&quot;</em>. (default: true)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>redirectRootLevelStories</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then stories URLs without a section (at <em>/:storySlug</em>) will redirect to the canonical url (default: false)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>mobileApiEnabled</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then <em>/mobile-data.json</em> will respond to mobile API requests. This is primarily used by the React Native starter kit. (default: true)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>mobileConfigFields</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>List of fields that are needed in the config field of the <em>/mobile-data.json</em> API. This is primarily used by the React Native starter kit. (default: {})</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>templateOptions</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then <em>/template-options.json</em> will return a list of available components so that components can be sorted in the CMS. This reads data from <em>config/template-options.yml</em>. See <a href="https://developers.quintype.com/malibu/tutorial/adding-a-homepage-component">Adding a homepage component</a> for more details</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>lightPages</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then all story pages will render amp pages.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>cdnProvider</code></td>
  

  <td class="type">
  
      
<code class="param-type">string</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>The name of the cdn provider. Supported cdn providers are akamai, cloudflare. Default value is cloudflare.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>maxConfigVersion</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An async function which resolves to a integer version of the config. This defaults to config.theme-attributes.cache-burst</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>redirectUrls</code></td>
  

  <td class="type">
  
      
<code class="param-type">Array.&lt;object></code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>An array or async function which used to render the redirect url provided in the array of object - &gt;ex- REDIRECT_URLS = [{sourceUrl: &quot;/tag/:tagSlug&quot;,destinationUrl: &quot;/topic/:tagSlug&quot;,statusCode: 301,}]</p></td>
</tr>

  


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>redirectToLowercaseSlugs</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>If set or evaluates to true, then for every story-page request having capital latin letters in the slug, it responds with a 301 redirect to the lowercase slug URL. (default: true)</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>shouldEncodeAmpUri</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>If set to true, then for every story-page request the slug will be encoded, in case of a vernacular slug this should be set to false. Receives path as param (default: true)</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>sMaxAge</code></td>
  

  <td class="type">
  
      
<code class="param-type">number</code>


  
  </td>

  

  

  <td class="description last"><p>Overrides the s-maxage value, the default value is set to 900 seconds. We can set <code>isomorphicRoutesSmaxage: 900</code> under <code>publisher</code> in publisher.yml config file that comes from BlackKnight or pass sMaxAge as a param.</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>maxAge</code></td>
  

  <td class="type">
  
      
<code class="param-type">number</code>


  
  </td>

  

  

  <td class="description last"><p>Overrides the max-age value, the default value is set to 15 seconds. We can set <code>isomorphicRoutesMaxage: 15</code> under <code>publisher</code> in publisher.yml config file that comes from BlackKnight or pass maxAge as a param.</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>fcmServerKey</code></td>
  

  <td class="type">
  
      
<code class="param-type">string</code>
|

<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>FCM serverKey is used for registering FCM Topic.</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>appLoadingPlaceholder</code></td>
  

  <td class="type">
  
      
<code class="param-type">string</code>


  
  </td>

  

  

  <td class="description last"><p>This string gets injected into the app container when the page is loaded via service worker. Can be used to show skeleton layouts, animations or other progress indicators before it is replaced by the page content.</p></td>
</tr>


        
        </tbody>
    </table>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line311">line 311</a>
            </span>
        </p>
    
</dl>





















</div>
            
                <div class="member">


    
    <h4 class="name" id=".proxyGetRequest">
        <a class="href-link" href="#.proxyGetRequest">#</a>
        
            
                <span class='tag'>static</span>
            
        
        <span class="code-name">
            
                proxyGetRequest<span class="signature">(app, route, handler, opts)</span><span class="type-signature"></span>
            
        </span>
    </h4>
    

    
    
    <div class="description">
        <p><em>proxyGetRequest</em> can be used to forward requests to another host, and cache the results on our CDN. This can be done as follows in <code>app/server/app.js</code>.</p>
<pre class="prettyprint source lang-javascript"><code>proxyGetRequest(app, &quot;/path/to/:resource.json&quot;, (params) => `https://example.com/${params.resource}.json`, {logError})
</code></pre>
<p>The handler can return the following:</p>
<ul>
<li>null / undefined - The result will be a 503</li>
<li>any truthy value - The result will be returned as a 200 with the result as content</li>
<li>A url starting with http(s) - The URL will be fetched and content will be returned according to the above two rules</li>
</ul>
    </div>
    









    <h5>Parameters:</h5>
    
<div class="table-container">
    <table class="params table">
        <thead>
        <tr>
            
            <th>Name</th>
            

            <th>Type</th>

            

            

            <th class="last">Description</th>
        </tr>
        </thead>

        <tbody>
        

            
<tr class="deep-level-0">
  
      <td class="name"><code>app</code></td>
  

  <td class="type">
  
      
<code class="param-type">Express</code>


  
  </td>

  

  

  <td class="description last"><p>The app to add the route to</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>route</code></td>
  

  <td class="type">
  
      
<code class="param-type">string</code>


  
  </td>

  

  

  <td class="description last"><p>The new route</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>handler</code></td>
  

  <td class="type">
  
      
<code class="param-type">function</code>


  
  </td>

  

  

  <td class="description last"><p>A function which takes params and returns a URL to proxy</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>opts</code></td>
  

  <td class="type">
  
  </td>

  

  

  <td class="description last"></td>
</tr>

  
  
    
<tr class="deep-level-1">
  
      <td class="name"><code>cacheControl</code></td>
  

  <td class="type">
  
  </td>

  

  

  <td class="description last"><p>The cache control header to set on proxied requests (default: <em>&quot;public,max-age=15,s-maxage=240,stale-while-revalidate=300,stale-if-error=3600&quot;</em>)</p></td>
</tr>

  


        
        </tbody>
    </table>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line600">line 600</a>
            </span>
        </p>
    
</dl>





















</div>
            
                <div class="member">


    
    <h4 class="name" id=".upstreamQuintypeRoutes">
        <a class="href-link" href="#.upstreamQuintypeRoutes">#</a>
        
            
                <span class='tag'>static</span>
            
        
        <span class="code-name">
            
                upstreamQuintypeRoutes<span class="signature">(app, opts)</span><span class="type-signature"></span>
            
        </span>
    </h4>
    

    
    
    <div class="description">
        <p><em>upstreamQuintypeRoutes</em> connects various routes directly to the upstream API server.</p>
<p>Requests like <em>/api/*</em> and <em>/stories.rss</em> are directly forwarded, but also it is also possible to forward other routes.</p>
    </div>
    









    <h5>Parameters:</h5>
    
<div class="table-container">
    <table class="params table">
        <thead>
        <tr>
            
            <th>Name</th>
            

            <th>Type</th>

            

            

            <th class="last">Description</th>
        </tr>
        </thead>

        <tbody>
        

            
<tr class="deep-level-0">
  
      <td class="name"><code>app</code></td>
  

  <td class="type">
  
      
<code class="param-type">Express</code>


  
  </td>

  

  

  <td class="description last"><p>The express app to add the routes to</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>opts</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>Options</p></td>
</tr>

  
  
    
<tr class="deep-level-1">
  
      <td class="name"><code>extraRoutes</code></td>
  

  <td class="type">
  
      
<code class="param-type">Array.&lt;string></code>


  
  </td>

  

  

  <td class="description last"><p>Additionally forward some routes upstream. This takes an array of express compatible routes, such as [&quot;/foo/*&quot;]</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>forwardAmp</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>Forward amp story routes upstream (default false)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>sMaxAge</code></td>
  

  <td class="type">
  
      
<code class="param-type">number</code>


  
  </td>

  

  

  <td class="description last"><p>Support overriding of proxied response cache header <code>s-maxage</code> from Sketches. For Breaking News and if the cacheability is Private, it is not overwritten instead the cache control will be the same as how it's set in sketches. We can set <code>upstreamRoutesSmaxage: 900</code> under <code>publisher</code> in publisher.yml config file that comes from BlackKnight or pass sMaxAge as a param.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>maxAge</code></td>
  

  <td class="type">
  
      
<code class="param-type">number</code>


  
  </td>

  

  

  <td class="description last"><p>Support overriding of proxied response cache header <code>maxage</code> from Sketches. For Breaking News and if the cacheability is Private, it is not overwritten instead the cache control will be the same as how it's set in sketches. We can set <code>upstreamRoutesMaxage: 15</code> under <code>publisher</code> in publisher.yml config file that comes from BlackKnight or pass maxAge as a param.</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>forwardFavicon</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>Forward favicon requests to the CMS (default false)</p></td>
</tr>

  
    
<tr class="deep-level-1">
  
      <td class="name"><code>isSitemapUrlEnabled</code></td>
  

  <td class="type">
  
      
<code class="param-type">boolean</code>


  
  </td>

  

  

  <td class="description last"><p>To enable /news_sitemap/today and /news_sitemap/yesterday sitemap news url (default /news_sitemap.xml)</p></td>
</tr>

  


        
        </tbody>
    </table>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line46">line 46</a>
            </span>
        </p>
    
</dl>





















</div>
            
                <div class="member">


    
    <h4 class="name" id="~getWithConfig">
        <a class="href-link" href="#~getWithConfig">#</a>
        
            
                <span class='tag'>inner</span>
            
        
        <span class="code-name">
            
                getWithConfig<span class="signature">(app, route, handler, opts)</span><span class="type-signature"></span>
            
        </span>
    </h4>
    

    
    
    <div class="description">
        <p>Use <em>getWithConfig</em> to handle GET requests. The handle that is accepted is of type <a href="module-routes.html#~Handler">module:routes~Handler</a>, which is similar to an express
handler, but already has a <em>client</em> initialized, and the <em>config</em> fetched from the server.</p>
    </div>
    









    <h5>Parameters:</h5>
    
<div class="table-container">
    <table class="params table">
        <thead>
        <tr>
            
            <th>Name</th>
            

            <th>Type</th>

            

            

            <th class="last">Description</th>
        </tr>
        </thead>

        <tbody>
        

            
<tr class="deep-level-0">
  
      <td class="name"><code>app</code></td>
  

  <td class="type">
  
      
<code class="param-type">Express</code>


  
  </td>

  

  

  <td class="description last"><p>Express app to add the route to</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>route</code></td>
  

  <td class="type">
  
      
<code class="param-type">string</code>


  
  </td>

  

  

  <td class="description last"><p>The route to implement</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>handler</code></td>
  

  <td class="type">
  
      
<code class="param-type"><a href="module-routes.html#~Handler">module:routes~Handler</a></code>


  
  </td>

  

  

  <td class="description last"><p>The Handler to run</p></td>
</tr>


        

            
<tr class="deep-level-0">
  
      <td class="name"><code>opts</code></td>
  

  <td class="type">
  
      
<code class="param-type">Object</code>


  
  </td>

  

  

  <td class="description last"><p>Options that will be passed to the handler. These options will be merged with a <em>config</em> and <em>client</em></p></td>
</tr>


        
        </tbody>
    </table>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line261">line 261</a>
            </span>
        </p>
    
</dl>





















</div>
            
            </div>
        </div>
    

    
        <div class='vertical-section'>
            <h1>Type Definitions</h1>
            <div class="members">
            
                <div class="member">

<h4 class="name" id="~Handler">
    <a class="href-link" href="#~Handler">#</a>
    
    <span class="code-name">
        Handler
    </span>
    
</h4>




<div class="description">
    <p>A handler is an extension of an express handler. Handlers are declared with the following arguments</p>
<pre class="prettyprint source lang-javascript"><code>function handler(req, res, next, { config, client, ...opts }) {
 // do something cool
}
</code></pre>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="server_routes.js.html" class="button">View Source</a>
            <span>
                <a href="server_routes.js.html">server/routes.js</a>, <a href="server_routes.js.html#line242">line 242</a>
            </span>
        </p>
    
</dl>





</div>
            
            </div>
        </div>
    

    
</article>

</section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>